<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <style>
    
    </style>
    <title>Datos </title>
</head>
<body onload="init()">  
    <header id="topnav">
        <div class="inner">
          <div class="logo">logo</div>
          <nav role='navigation'>
            <ul>
              <li><a href="/" >Home</a></li>
              <li><a href="/dashBoard">dashBoard</a></li>
              <li><a href="/red" >Red</a></li>
              <li><a href="/conf" class="act">Configuracion</a></li>
              <li><a href="/cont">Contacto</a></li>
            </ul>
          </nav>  
        </div>
      </header>
      <section>
        <div class="inner">
                    <div class="col-12 ">
                            <h1 class="title">Datos</h1>
                            <div class="">
                                
                              <div class="col-12">
                                
                                <label for="" class="col-2">mqtt_server</label>                                
                                <input type="text" class="col-5" name="mqtt_server" id="mqtt_server" placeholder="mqtt_server " required="required" value=""  /><br>
                              </div>
                              <div class="col-12">
                                
                                <label for="" class="col-2">mqtt_port</label>                                
                                <input type="text" class="col-5" name="mqtt_port" id="mqtt_port" placeholder="mqtt_port " required="required" value=""  /><br>
                              </div>
                              <div class="col-12">
                                
                                <label for="" class="col-2">Usuario Server</label>                                                                
                                <input type="text" class="col-5" name="uServer" id="uServer" placeholder="Usuario Server " required="required"  value="" /><br>
                              </div>
                              <div class="col-12">
                                
                                <label for="" class="col-2">Pass Server</label>                                
                                <input type="text" class="col-5" name="pServer" id="pServer" placeholder="Pass Server" required="required"  value="" /><br>
                              </div>
                              <div class="col-12">
                                
                                <label for="" class="col-2">root </label>                                
                                <input type="text" class="col-5" name="root" id="root" placeholder="root " required="required"  value=""  /><br>
                              </div>
                              <div class="col-12">
                                
                                <label for="" class="col-2">root_topic_subscribe </label>                                
                                <input type="text" class="col-5" name="rootSubs" id="rootSubs" placeholder="root_topic_subscribe " required="required"  value=""  /><br>
                              </div>
                              <div class="col-12">
                                
                                <label for="" class="col-2">root_topic_publish </label>                                
                                <input type="text" class="col-5" name="rootPublish" id="rootPublish" placeholder="root_topic_publish " required="required"  value=""  /><br>
                              </div>
                              <div class="col-12">
                                
                                <label for="" class="col-2">ID</label>                                
                                <input type="number" class="col-5" name="idDevice" id="idDevice" placeholder="ID" required="required"  value="" /><br>
                              </div>
                              <div class="col-12">

                                <label for="" class="col-2" >Tiempo </label>                                
                                <input type="text" class="col-5" name="r1" id="r1" placeholder="Tiempo Relay En Seg" required="required"  value=""  /><br>
                              </div>
                              <div class="col-12">

                                <label for="" class="col-2" >usr </label>                                
                                <input type="text" class="col-5" name="usrApn" id="usrApn" placeholder="" required="required"  value=""  /><br>
                              </div>
                              <div class="col-12">

                                <label for="" class="col-2" >passApn </label>                                
                                <input type="text" class="col-5" name="pasApn" id="pasApn" placeholder="" required="required"  value=""  /><br>
                              </div>
                              <div class="col-12">

                                <label for="" class="col-2" >Apn </label>                                
                                <input type="text" class="col-5" name="apn" id="apn"  required="required"    /><br>
                              </div>

                              <div class="col-12">

                                <label for="" class="col-2" >s1 </label>                                
                                <input type="checkbox" class="col-5" name="s1" id="s1"  required="required"    /><br>
                              </div>
                              <div class="col-12">

                                <label for="" class="col-2" >s2 </label>                                
                                <input type="checkbox" class="col-5" name="s2" id="s2"  required="required"    /><br>
                              </div>
                              <div class="col-12">

                                <label for="" class="col-2" >s3 </label>                                
                                <input type="checkbox" class="col-5" name="s3" id="s3"  required="required"    /><br>
                              </div>
                              <div class="col-12">

                                <label for="" class="col-2" >s4 </label>                                
                                <input type="checkbox" class="col-5" name="s4" id="s4"  required="required"    /><br>
                              </div>
                              <div class="col-12">

                                <label for="" class="col-2" >s5 </label>                                
                                <input type="checkbox" class="col-5" name="s5" id="s5"  required="required"    /><br>
                              </div>
                              <div class="col-12">

                                <label for="" class="col-2" >s6 </label>                                
                                <input type="checkbox" class="col-5" name="s6" id="s6"  required="required"    /><br>
                              </div>
                  
                            </div>
                            <div  id="actnodo">
        

                            </div>
                            
                            <span id ="ip"></span>
                   
                 
             
                <div class="col-12">
                    <div class="col-5">
                      <button type="button" class="btn btn-primary " name="button" onclick="enviar()">Guardar</button>
                      
                    </div>
                    <div class="col-5">
                      <button type="button" class="btn btn-primary " name="button" onclick="reset()">Reset</button>
                    </div>
                </div>
            </div>
            </div></div>
      </section>
    
</body>
    <script>

    function init(){
        var xhttp = new XMLHttpRequest();

            xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                var json = JSON.parse(this.responseText,"text/json");
                document.getElementById("r1").value = json.r1;
                document.getElementById("mqtt_server").value = json.mqtt_server; 
                document.getElementById("mqtt_port").value = json.mqtt_port; 
                document.getElementById("uServer").value = json.mqtt_user; 
                document.getElementById("pServer").value = json.mqtt_pass; 

                document.getElementById("root").value = json.uroot; 
                document.getElementById("rootSubs").value = json.root_topic_subscribe; 
                document.getElementById("rootPublish").value = json.root_topic_publish; 
                document.getElementById("idDevice").value = json.idDevice;
                document.getElementById("usrApn").value = json.usrApn;
                document.getElementById("pasApn").value = json.pasApn;
                document.getElementById("apn").value = json.apn;
                if(json.s1==1)
                  document.getElementById("s1").checked = true;
                else
                  document.getElementById("s1").checked = false;
                if(json.s2==1)
                  document.getElementById("s2").checked = true;
                else
                  document.getElementById("s2").checked = false;
                if(json.s3==1)
                  document.getElementById("s3").checked = true;
                else
                  document.getElementById("s3").checked = false;
                if(json.s4==1)
                  document.getElementById("s4").checked = true;
                else
                  document.getElementById("s4").checked = false;
                if(json.s5==1)
                  document.getElementById("s5").checked = true;
                else
                  document.getElementById("s5").checked = false;
                if(json.s6==1)
                  document.getElementById("s6").checked = true;
                else
                  document.getElementById("s6").checked = false;
                
              }
            };
            xhttp.open("GET", "datosInit", true);
            xhttp.send();
          }
          function reset(){
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
              if (this.readyState == 4 && this.status == 200) {
                
                mqtt_server = document.getElementById("mqtt_server").value =" ";
                mqtt_port = document.getElementById("mqtt_port").value =" ";
                uServer = document.getElementById("uServer").value =" ";
                pServer = document.getElementById("pServer").value =" ";

                root = document.getElementById("root").value =" ";
                rootSubs = document.getElementById("rootSubs").value =" ";
                rootPublish = document.getElementById("rootPublish").value =" ";
                
                alert('Reiniciado');

                }
            };
  
            xhttp.open("GET", "reset", true);
            xhttp.send();
    }

    function enviar(){
            var xhttp = new XMLHttpRequest();
        xhttp.onload = function() {
         if (this.readyState == 4 && this.status == 200) {
       
            document.getElementById("ip").innerHTML =  this.responseText;
 
            alert("Guardado");
            }
         };

         r1 = document.getElementById("r1").value;
         mqtt_server = document.getElementById("mqtt_server").value;
         mqtt_port = document.getElementById("mqtt_port").value;
         uServer = document.getElementById("uServer").value;
         pServer = document.getElementById("pServer").value;

         root = document.getElementById("root").value;
         rootSubs = document.getElementById("rootSubs").value;
         rootPublish = document.getElementById("rootPublish").value;


         idDevice = document.getElementById("idDevice").value;
         usrApn = document.getElementById("usrApn").value;
         pasApn = document.getElementById("pasApn").value;
         apn = document.getElementById("apn").value;
         s1 = document.getElementById("s1").checked;
         s2 = document.getElementById("s2").checked;
         s3 = document.getElementById("s3").checked;
         s4 = document.getElementById("s4").checked;
         s5 = document.getElementById("s5").checked;
         s6 = document.getElementById("s6").checked;
 
    
        xhttp.open("GET",
        "saveDatos?"
        + "tSleep1="+ r1 + "&mqtt_server="+mqtt_server + "&mqtt_port="+mqtt_port
        + "&uServer="+uServer + "&pServer="+pServer+  "&idDevice="+idDevice 
        + "&root="+root + "&rootSubs="+rootSubs + "&rootPublish="+ rootPublish 
        + "&usrApn="+usrApn + "&pasApn="+pasApn + "&apn="+ apn 
        + "&s1="+ s1 + "&s2="+ s2 + "&s3="+ s3 + "&s4="+ s4 + "&s5="+ s5 + "&s6="+ s6 
        ,true);

       // xhttp.open("GET", "saveValues?"+"values={\"data\":[\""+ipserver + "\",\""+passowrd + "\",\""+ip + "\",\""+gateway + "\",\""+subnet + "\","  +  +r1 + "]}", true);
        xhttp.timeout = 15000;
        xhttp.send();
    }
    </script>
</html>